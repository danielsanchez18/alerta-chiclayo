<!-- Page Create Comunity -->
<section class="grid gap-y-5 p-5">

  <form class="grid gap-y-7">

    <!-- Input Name -->
    <div class="grid gap-y-2">

      <label for="community" class="text-sm capitalize  tracking-wider">Nombre:</label>

      <input type="text" id="community" name="community" placeholder="Ingrese el nombre de la comunidad"
        class="text-sm w-full px-5 py-3 rounded-lg bg-white/10 border border-white/10 focus:border-primary focus:outline-primary placeholder:text-white/50 text-white transition" />
    </div>

    <!-- Input Descripcion -->
    <div class="grid gap-y-2">

      <label for="description" class="text-sm capitalize tracking-wider">Descripci贸n:</label>

      <textarea name="" id="" rows="3"
        class="w-full px-5 text-sm py-3 text-white bg-white/10 border border-white/10 rounded-lg focus:border-primary focus:outline-primary placeholder:text-white/50 resize-none scrollbar-hide"
        placeholder="Escribe una descripcion breve de la comunidad"></textarea>
    </div>

    <!-- Select Departamento -->
    <div class="grid gap-y-2">

      <label for="departamento" class="text-sm capitalize tracking-wider">Departamento:</label>

      <select 
        name="departamento" 
        id="departamento" 
        [(ngModel)]="selectedDepartamento"
        (ngModelChange)="onDepartamentoChange($event)"
        class="bg-white/10 text-white text-sm w-full px-5 py-3 rounded-lg border border-white/10 focus:border-primary focus:outline-primary">
        <option class="bg-black/80 text-white/60" value="">Seleccione un departamento</option>
        @for (dept of departamentosList(); track dept) {
          <option class="bg-black/80 text-white" [value]="dept">{{ dept }}</option>
        }
      </select>
    </div>

    <!-- Select Provincia -->
    <div class="grid gap-y-2">

      <label for="provincia" class="text-sm capitalize tracking-wider">Provincia:</label>

      <select 
        name="provincia" 
        id="provincia" 
        [(ngModel)]="selectedProvincia"
        (ngModelChange)="onProvinciaChange($event)"
        [disabled]="!selectedDepartamento()"
        class="bg-white/10 text-white text-sm w-full px-5 py-3 rounded-lg border border-white/10 focus:border-primary focus:outline-primary disabled:opacity-50">
        <option class="bg-black/80 text-white/60" value="">Seleccione una Provincia</option>
        @for (prov of provinciasList(); track prov) {
          <option class="bg-black/80 text-white" [value]="prov">{{ prov }}</option>
        }
      </select>
    </div>

    <!-- Select Distrito -->
    <div class="grid gap-y-2">

      <label for="distrito" class="text-sm capitalize tracking-wider">Distrito:</label>

      <select 
        name="distrito" 
        id="distrito" 
        [(ngModel)]="selectedDistrito"
        (ngModelChange)="onDistritoChange($event)"
        [disabled]="!selectedProvincia()"
        class="bg-white/10 text-white text-sm w-full px-5 py-3 rounded-lg border border-white/10 focus:border-primary focus:outline-primary disabled:opacity-50">
        <option class="bg-black/80 text-white/60" value="">Seleccione un Distrito</option>
        @for (dist of distritosList(); track dist) {
          <option class="bg-black/80 text-white" [value]="dist">{{ dist }}</option>
        }
      </select>
    </div>

    <!-- Mapa de delimitaci贸n -->
    <div class="grid gap-y-2">
      <label class="text-sm tracking-wider">Seleccione su delimitaci贸n:</label>
      
      <select 
        name="delimitacion" 
        id="delimitacion" 
        [(ngModel)]="selectedDelimitacion"
        (ngModelChange)="onDelimitacionChange($event)"
        class="bg-white/10 text-white text-sm w-full px-5 py-3 rounded-lg border border-white/10 focus:border-primary focus:outline-primary">
        <option class="bg-black/80 text-white" [value]="500">500 metros</option>
        <option class="bg-black/80 text-white" [value]="1000">1 kil贸metro</option>
        <option class="bg-black/80 text-white" [value]="1500">1.5 kil贸metros</option>
        <option class="bg-black/80 text-white" [value]="2000">2 kil贸metros</option>
        <option class="bg-black/80 text-white" [value]="3000">3 kil贸metros</option>
      </select>

      <div class="bg-white/5 rounded-lg p-3 text-sm">
        <p class="text-white/70">
           Radio de cobertura: <span class="text-primary font-semibold">{{ selectedDelimitacion() }}m</span>
        </p>
        <p class="text-white/50 text-xs mt-1">
           Arrastra el marcador para ajustar el centro de tu comunidad
        </p>
      </div>
      
      <div class="h-[20rem] rounded-lg overflow-hidden relative mt-3">
        @if (!mapLoaded()) {
          <div class="flex items-center justify-center h-full bg-white/10">
            <div class="text-center">
              <div class="loader mx-auto mb-3"></div>
              <p class="text-white/60 text-sm">Cargando mapa...</p>
            </div>
          </div>
        }
        <div id="delimitation-map" class="h-full w-full" [class.hidden]="!mapLoaded()"></div>
      </div>
    </div>



    <button type="submit" class="flex items-center justify-center w-full rounded-full text-black bg-primary hover:bg-primary/90 transition px-4 py-3 gap-x-2 uppercase font-semibold">
      Crear comunidad
    </button>
  </form>

</section>

<style>
  .loader {
    width: 48px;
    height: 48px;
    border: 5px solid;
    border-color: #d5e301 transparent;
    border-radius: 50%;
    display: inline-block;
    box-sizing: border-box;
    animation: rotation 1s linear infinite;
  }

  @keyframes rotation {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
<!-- End Page Create Comunity -->
